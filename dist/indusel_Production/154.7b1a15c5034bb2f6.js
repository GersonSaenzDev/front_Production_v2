"use strict";(self.webpackChunkfree_version=self.webpackChunkfree_version||[]).push([[154],{7154:(O,g,i)=>{i.r(g),i.d(g,{ViewNews:()=>w});var m=i(177),l=i(2200),u=i(8728),e=i(3664),f=i(4799),d=i(9417),h=i(8312);function p(r,c){if(1&r&&(e.j41(0,"div",21)(1,"span",22),e.EFF(2),e.k0s(),e.j41(3,"span",23),e.EFF(4),e.k0s(),e.j41(5,"span",24),e.EFF(6),e.k0s()()),2&r){const t=c.$implicit,a=e.XpG(2);e.Y8G("ngClass",a.getCategoryClass(t.category)),e.R7$(2),e.JRh(t.totalTime),e.R7$(2),e.JRh(t.category),e.R7$(2),e.Lme(" ",t.count," Novedad",t.count>1?"es":""," ")}}function _(r,c){if(1&r&&(e.j41(0,"div",19),e.DNE(1,p,7,5,"div",20),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.categorySummaries)}}function C(r,c){1&r&&(e.j41(0,"tr")(1,"td",25),e.EFF(2," Cargando novedades... "),e.k0s()())}function M(r,c){1&r&&(e.j41(0,"tr")(1,"td",25),e.EFF(2," No se encontraron novedades para esta fecha. "),e.k0s()())}function P(r,c){if(1&r&&(e.j41(0,"tr",26)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s()()),2&r){const t=c.$implicit,a=e.XpG();e.Y8G("ngClass",a.getCategoryClass(t.category)),e.R7$(2),e.JRh(t.category),e.R7$(2),e.JRh(t.assemblyLine),e.R7$(2),e.JRh(t.reference),e.R7$(2),e.JRh(t.stopType||"N/A"),e.R7$(2),e.Lme("",t.startTime," - ",t.endTime),e.R7$(2),e.JRh(t.totalTime),e.R7$(2),e.JRh(t.responsible||"N/A"),e.R7$(2),e.JRh(t.detail)}}(0,m.EO)(f.A,"es");let w=(()=>{class r{constructor(){this.selectedDate=this.formatDate(new Date),this.searchTerm="",this.isLoading=!1,this.allNews=[],this.filteredNews=[],this.paginatedNews=[],this.categorySummaries=[],this.currentPage=1,this.pageSize=10,this.totalPages=1,this.dashboardService=(0,u.WQX)(h.T)}ngOnInit(){this.onDateChange()}onDateChange(){const t=this.formatDateForBackend(this.selectedDate);this.loadAllData(t)}loadAllData(t){console.log("Cargando datos para:",t),this.isLoading=!0,this.allNews=[],this.categorySummaries=[],this.dashboardService.viewNews(t).subscribe({next:a=>{a.ok&&a.msg?(this.allNews=a.msg,console.log("Datos recibidos:",this.allNews),this.calculateCategorySummaries()):this.allNews=[]},error:a=>{console.error("Error al cargar novedades:",a.message),this.allNews=[],this.categorySummaries=[],this.isLoading=!1,this.applyFilter()},complete:()=>{this.isLoading=!1,this.applyFilter()}})}calculateCategorySummaries(){const t=new Map;for(const a of this.allNews){const n=a.category,o=this.parseTimeToMinutes(a.totalTime),s=t.get(n)||{totalMinutes:0,count:0};s.totalMinutes+=o,s.count+=1,t.set(n,s)}this.categorySummaries=[];for(const[a,n]of t.entries())this.categorySummaries.push({category:a,totalTime:this.formatMinutesToDisplay(n.totalMinutes),count:n.count})}parseTimeToMinutes(t){if(!t)return 0;const a=t.split(":");if(a.length<2)return 0;const n=parseInt(a[0],10),o=parseInt(a[1],10);return isNaN(n)||isNaN(o)?0:60*n+o}formatMinutesToDisplay(t){const a=Math.floor(t/60),n=t%60;return a>0?`${a}h ${n}m`:`${n}m`}applyFilter(){const t=this.searchTerm.toLowerCase();this.filteredNews=this.allNews.filter(a=>a.category.toLowerCase().includes(t)||a.assemblyLine.toLowerCase().includes(t)||a.reference.toLowerCase().includes(t)||(a.responsible||"").toLowerCase().includes(t)||(a.detail||"").toLowerCase().includes(t)),this.currentPage=1,this.updatePagination()}updatePagination(){this.totalPages=Math.ceil(this.filteredNews.length/this.pageSize),0===this.totalPages&&(this.totalPages=1);const t=(this.currentPage-1)*this.pageSize;this.paginatedNews=this.filteredNews.slice(t,t+this.pageSize)}prevPage(){this.currentPage>1&&(this.currentPage--,this.updatePagination())}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.updatePagination())}getCategoryClass(t){switch(t){case"Parada de Linea":return"row-parada";case"Reporte de Calidad":return"row-calidad";case"Reporte Material":return"row-material";case"Reporte Mantenimiento":return"row-mantenimiento";default:return"row-default"}}formatDate(t){const a=new Date(t);let n=""+(a.getMonth()+1),o=""+a.getDate();const s=a.getFullYear();return n.length<2&&(n="0"+n),o.length<2&&(o="0"+o),[s,n,o].join("-")}formatDateForBackend(t){const a="string"==typeof t?new Date(t.replace(/-/g,"/")):t;let n=""+a.getDate(),o=""+(a.getMonth()+1);const s=a.getFullYear();return o.length<2&&(o="0"+o),n.length<2&&(n="0"+n),[n,o,s].join("/")}static{this.\u0275fac=function(a){return new(a||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-view-news"]],features:[e.Jv_([{provide:e.xe9,useValue:"es"}])],decls:51,vars:16,consts:[[1,"inventory-container"],[1,"header"],[1,"header-title"],[1,"header-parameters"],[1,"form-group","mb-0"],["type","date","id","headerNewsDate",1,"form-control",3,"ngModelChange","ngModel"],[1,"header-summary-text"],[1,"main-content"],[1,"right-panel"],[1,"d-flex","justify-content-between","align-items-center"],[1,"form-group","mb-0",2,"width","300px"],["type","text","placeholder","Buscar por categor\xeda, l\xednea, ref...",1,"form-control",3,"ngModelChange","input","ngModel"],["class","summary-counters",4,"ngIf"],[1,"table-responsive","mt-3"],[1,"table","table-hover"],[4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"pagination-controls","mt-3"],[1,"btn-secondary",3,"click","disabled"],[1,"summary-counters"],["class","summary-card",3,"ngClass",4,"ngFor","ngForOf"],[1,"summary-card",3,"ngClass"],[1,"summary-time"],[1,"summary-category"],[1,"summary-count"],["colspan","8",1,"text-center","text-muted"],[3,"ngClass"]],template:function(a,n){1&a&&(e.j41(0,"div",0)(1,"header",1)(2,"h2",2),e.EFF(3,"Consultar Novedades de Producci\xf3n"),e.k0s(),e.j41(4,"div",3)(5,"div",4)(6,"input",5),e.mxI("ngModelChange",function(s){return e.DH7(n.selectedDate,s)||(n.selectedDate=s),s}),e.bIt("ngModelChange",function(){return n.onDateChange()}),e.k0s()(),e.j41(7,"p",6),e.EFF(8," Mostrando novedades para: "),e.j41(9,"strong"),e.EFF(10),e.nI1(11,"date"),e.k0s()()()(),e.j41(12,"main",7)(13,"div",8)(14,"div",9)(15,"h3"),e.EFF(16,"Novedades Reportadas"),e.k0s(),e.j41(17,"div",10)(18,"input",11),e.mxI("ngModelChange",function(s){return e.DH7(n.searchTerm,s)||(n.searchTerm=s),s}),e.bIt("input",function(){return n.applyFilter()}),e.k0s()()(),e.DNE(19,_,2,1,"div",12),e.j41(20,"div",13)(21,"table",14)(22,"thead")(23,"tr")(24,"th"),e.EFF(25,"Categor\xeda"),e.k0s(),e.j41(26,"th"),e.EFF(27,"L\xednea"),e.k0s(),e.j41(28,"th"),e.EFF(29,"Referencia"),e.k0s(),e.j41(30,"th"),e.EFF(31,"Tipo Parada"),e.k0s(),e.j41(32,"th"),e.EFF(33,"Horario"),e.k0s(),e.j41(34,"th"),e.EFF(35,"Tiempo Total"),e.k0s(),e.j41(36,"th"),e.EFF(37,"Responsable"),e.k0s(),e.j41(38,"th"),e.EFF(39,"Detalle"),e.k0s()()(),e.j41(40,"tbody"),e.DNE(41,C,3,0,"tr",15)(42,M,3,0,"tr",15)(43,P,17,10,"tr",16),e.k0s()()(),e.j41(44,"div",17)(45,"button",18),e.bIt("click",function(){return n.prevPage()}),e.EFF(46," Anterior "),e.k0s(),e.j41(47,"span"),e.EFF(48),e.k0s(),e.j41(49,"button",18),e.bIt("click",function(){return n.nextPage()}),e.EFF(50," Siguiente "),e.k0s()()()()()),2&a&&(e.R7$(6),e.R50("ngModel",n.selectedDate),e.R7$(4),e.JRh(e.ii3(11,11,n.selectedDate,"fullDate","","es")),e.R7$(8),e.R50("ngModel",n.searchTerm),e.R7$(),e.Y8G("ngIf",n.categorySummaries.length>0&&!n.isLoading),e.R7$(22),e.Y8G("ngIf",n.isLoading),e.R7$(),e.Y8G("ngIf",!n.isLoading&&0===n.paginatedNews.length),e.R7$(),e.Y8G("ngForOf",n.paginatedNews),e.R7$(2),e.Y8G("disabled",1===n.currentPage),e.R7$(3),e.Lme(" P\xe1gina ",n.currentPage," de ",n.totalPages," "),e.R7$(),e.Y8G("disabled",n.currentPage===n.totalPages))},dependencies:[l.MD,l.YU,l.Sq,l.bT,l.vh,d.YN,d.me,d.BC,d.vS],styles:['@import"https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap";@charset "UTF-8";.inventory-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;font-family:Inter,sans-serif;background:#f5f7fa}.header[_ngcontent-%COMP%]{background:linear-gradient(90deg,#87d1e6,#036);color:#fff;padding:1rem 1.5rem;box-shadow:0 4px 8px #0000001f;border-radius:10px;margin:1rem;display:flex;justify-content:space-between;align-items:center}.header-title[_ngcontent-%COMP%]{font-weight:600;font-size:1.6rem;margin:0;padding:0;flex:1}.header-parameters[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem}.header-parameters[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:0;min-width:200px}.header-parameters[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:.5rem .75rem;font-weight:600;color:#036;color-scheme:light}.header-parameters[_ngcontent-%COMP%]   .header-summary-text[_ngcontent-%COMP%]{font-size:.85rem;color:#f0f4ff;margin:0;padding-top:1.7rem;max-width:250px}.header-parameters[_ngcontent-%COMP%]   .header-summary-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#fff;display:block;font-weight:600}.main-content[_ngcontent-%COMP%]{max-width:1600px;margin:.5rem auto 1.5rem;width:100%;padding:0 1rem}.right-panel[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 8px 18px #0000000f;width:100%}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}label[_ngcontent-%COMP%]{font-weight:600;color:#3b5998;margin-bottom:.5rem;display:block}.form-control[_ngcontent-%COMP%]{border-radius:8px;padding:.6rem .9rem;border:1px solid #d6dde8;width:100%}.summary-counters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-top:1.5rem;padding-bottom:1.5rem;border-bottom:1px solid #e6eefc}.summary-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e6eefc;border-radius:8px;padding:1rem;min-width:180px;flex:1;display:flex;flex-direction:column;gap:.25rem;box-shadow:0 2px 4px #00000005;border-left-width:5px}.summary-card[_ngcontent-%COMP%]   .summary-time[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600}.summary-card[_ngcontent-%COMP%]   .summary-category[_ngcontent-%COMP%]{font-size:.9rem;font-weight:600;color:#333}.summary-card[_ngcontent-%COMP%]   .summary-count[_ngcontent-%COMP%]{font-size:.8rem;color:#777}.summary-card.row-parada[_ngcontent-%COMP%]{background-color:#ef535033;border-left-color:#ef5350}.summary-card.row-parada[_ngcontent-%COMP%]   .summary-time[_ngcontent-%COMP%], .summary-card.row-parada[_ngcontent-%COMP%]   .summary-category[_ngcontent-%COMP%]{color:#d32f2f}.summary-card.row-calidad[_ngcontent-%COMP%]{border-left-color:#ffc107}.summary-card.row-calidad[_ngcontent-%COMP%]   .summary-time[_ngcontent-%COMP%]{color:#ffc107}.summary-card.row-material[_ngcontent-%COMP%]{border-left-color:#42a5f5}.summary-card.row-material[_ngcontent-%COMP%]   .summary-time[_ngcontent-%COMP%]{color:#42a5f5}.summary-card.row-mantenimiento[_ngcontent-%COMP%]{border-left-color:coral}.summary-card.row-mantenimiento[_ngcontent-%COMP%]   .summary-time[_ngcontent-%COMP%]{color:coral}.summary-card.row-default[_ngcontent-%COMP%]{border-left-color:#a0aec0}.summary-card.row-default[_ngcontent-%COMP%]   .summary-time[_ngcontent-%COMP%]{color:#a0aec0}.table-responsive[_ngcontent-%COMP%]{width:100%;overflow-x:auto;border:1px solid #e6eefc;border-radius:8px}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border-bottom:1px solid #e6eefc;text-align:left;vertical-align:middle;font-size:.9rem;max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{white-space:normal;max-width:300px}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#3b5998;font-weight:600}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .2s ease}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f0f4ff}.row-parada[_ngcontent-%COMP%]{background-color:#ef535033}.row-parada[_ngcontent-%COMP%]:hover{background-color:#ef53504d}.row-calidad[_ngcontent-%COMP%]{background-color:#ffc10733}.row-calidad[_ngcontent-%COMP%]:hover{background-color:#ffc1074d}.row-material[_ngcontent-%COMP%]{background-color:#42a5f533}.row-material[_ngcontent-%COMP%]:hover{background-color:#42a5f54d}.row-mantenimiento[_ngcontent-%COMP%]{background-color:#ff7f5033}.row-mantenimiento[_ngcontent-%COMP%]:hover{background-color:#ff7f504d}.row-default[_ngcontent-%COMP%]{background-color:#fff}.pagination-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:1.5rem}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#4b6cb7;border:none;color:#fff;padding:.6rem 1rem;border-radius:8px;font-weight:600;cursor:pointer;transition:background-color .2s ease}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:#3b5998}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background:#a0aec0;cursor:not-allowed;opacity:.7}.pagination-controls[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#3b5998;font-size:.9rem}@media (max-width: 900px){.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.header-parameters[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.5rem;width:100%}.header-parameters[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{width:100%}.header-parameters[_ngcontent-%COMP%]   .header-summary-text[_ngcontent-%COMP%]{padding-top:0;max-width:100%}.right-panel[_ngcontent-%COMP%]   .d-flex[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.right-panel[_ngcontent-%COMP%]   .d-flex[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{width:100%!important}}']})}}return r})()}}]);