"use strict";(self.webpackChunkfree_version=self.webpackChunkfree_version||[]).push([[957],{957:(v,_,d)=>{d.r(_),d.d(_,{InventoryReport:()=>O});var l=d(8728),c=d(2200),p=d(9417),u=d(8312),g=d(2288),t=d(3664);const f=(o,s)=>s.referencia,h=(o,s)=>s.barcode;function m(o,s){1&o&&(t.j41(0,"div",21),t.nrm(1,"div",22),t.j41(2,"p",23),t.EFF(3,"Procesando informaci\xf3n de inventario..."),t.k0s()())}function C(o,s){if(1&o&&(t.j41(0,"tr")(1,"td")(2,"code"),t.EFF(3),t.k0s()(),t.j41(4,"td"),t.EFF(5),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td")(9,"span",38),t.EFF(10),t.k0s()(),t.j41(11,"td"),t.EFF(12),t.k0s()()),2&o){const n=s.$implicit;t.R7$(3),t.JRh(n.barcode),t.R7$(2),t.JRh(n.consecutive),t.R7$(2),t.JRh(n.fechaCaptura),t.R7$(2),t.Y8G("ngClass","Conforme"===n.estado?"bg-success":"bg-warning text-dark"),t.R7$(),t.SpI(" ",n.estado," "),t.R7$(2),t.JRh(n.novedades||"Sin novedades")}}function M(o,s){if(1&o&&(t.j41(0,"div",35)(1,"div",36)(2,"table",37)(3,"thead")(4,"tr")(5,"th"),t.EFF(6,"Barcode"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Consecutivo"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Fecha Captura"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Estado"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Novedades"),t.k0s()()(),t.j41(15,"tbody"),t.Z7z(16,C,13,6,"tr",null,h),t.k0s()()()()),2&o){const n=t.XpG().$implicit;t.R7$(16),t.Dyx(n.items)}}function b(o,s){if(1&o){const n=t.RV6();t.j41(0,"div",26)(1,"div",27),t.bIt("click",function(){const e=l.eBV(n).$implicit,i=t.XpG(2);return l.Njj(i.toggleGroup(e))}),t.j41(2,"div",28),t.nrm(3,"i",29),t.j41(4,"span",30),t.EFF(5),t.k0s(),t.j41(6,"span",31),t.EFF(7),t.nI1(8,"uppercase"),t.k0s()(),t.j41(9,"div",32)(10,"span",33),t.EFF(11),t.k0s(),t.j41(12,"span",34),t.EFF(13,"Items"),t.k0s()()(),t.nVh(14,M,18,0,"div",35),t.k0s()}if(2&o){const n=s.$implicit;t.AVh("active",n.isExpanded),t.R7$(3),t.AVh("rotated",n.isExpanded),t.R7$(2),t.JRh(n.referencia),t.R7$(2),t.JRh(t.bMT(8,8,n.producto)),t.R7$(4),t.JRh(n.conteoTotal),t.R7$(3),t.vxM(n.isExpanded?14:-1)}}function x(o,s){1&o&&(t.j41(0,"div",25),t.nrm(1,"i",39),t.j41(2,"p",40),t.EFF(3,"No se encontraron resultados para los criterios seleccionados."),t.k0s()())}function P(o,s){if(1&o&&t.Z7z(0,b,15,10,"div",24,f,!1,x,4,0,"div",25),2&o){const n=t.XpG();t.Dyx(n.filteredGroups)}}let O=(()=>{class o{constructor(){this.dashboardService=(0,l.WQX)(u.T),this.dateIni="2026-01-02",this.dateEnd="2026-01-07",this.searchTerm="",this.isLoading=!1,this.groupedData=[],this.filteredGroups=[],this.totalRefs=0,this.totalItems=0}ngOnInit(){this.loadReport()}loadReport(){this.isLoading=!0,this.dashboardService.getFinalInventoryReport(this.formatDateForBackend(this.dateIni),this.formatDateForBackend(this.dateEnd)).subscribe({next:n=>{this.groupedData=(n.data||[]).map(r=>({...r,isExpanded:!1})),this.totalRefs=n.totalGrupos||this.groupedData.length,this.calculateGlobalTotals(this.groupedData),this.applyFilter()},error:n=>{console.error("Error cargando inventario",n),this.isLoading=!1},complete:()=>this.isLoading=!1})}calculateGlobalTotals(n){this.totalItems=n.reduce((r,e)=>r+e.conteoTotal,0)}toggleGroup(n){n.isExpanded=!n.isExpanded}applyFilter(){const n=this.searchTerm.toLowerCase().trim();this.filteredGroups=n?this.groupedData.filter(r=>r.referencia.toLowerCase().includes(n)||r.producto.toLowerCase().includes(n)||r.items.some(e=>e.barcode.includes(n))):[...this.groupedData]}exportToExcel(){const n=this.groupedData.flatMap(i=>i.items.map(a=>({Referencia:i.referencia,Producto:i.producto,Barcode:a.barcode,Consecutivo:a.consecutive,Fecha:a.fechaCaptura,Estado:a.estado,Novedades:a.novedades}))),r=g.Wp.json_to_sheet(n),e=g.Wp.book_new();g.Wp.book_append_sheet(e,r,"Reporte Detallado"),g._h(e,`Inventario_${this.dateIni}_al_${this.dateEnd}.xlsx`)}formatDateForBackend(n){const[r,e,i]=n.split("-");return`${i}/${e}/${r}`}static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-inventory-report"]],decls:43,vars:10,consts:[[1,"report-wrapper"],[1,"inventory-header"],[1,"title-section"],[1,"filter-params"],[1,"date-input-group"],["type","date",3,"ngModelChange","ngModel"],[1,"stats-grid"],[1,"stat-card"],[1,"ti","ti-tags","stat-icon"],[1,"stat-content"],[1,"stat-value"],[1,"stat-label"],[1,"stat-card","secondary"],[1,"ti","ti-box","stat-icon"],[1,"action-bar"],[1,"search-box"],[1,"ti","ti-search"],["type","text","placeholder","Buscar por referencia, producto o barcode...",3,"ngModelChange","input","ngModel"],[1,"btn-excel",3,"click"],[1,"ti","ti-file-spreadsheet"],[1,"groups-list"],[1,"text-center","p-5"],["role","status",1,"spinner-border","text-primary"],[1,"mt-2","text-muted","fw-bold"],[1,"group-item",3,"active"],[1,"text-center","p-5","bg-white","rounded-3","shadow-sm"],[1,"group-item"],[1,"group-header",3,"click"],[1,"main-info"],[1,"ti","ti-chevron-right","arrow"],[1,"ref-code"],[1,"prod-name"],[1,"group-badge"],[1,"count"],[1,"label"],[1,"group-detail"],[1,"table-responsive"],[1,"table"],[1,"badge",3,"ngClass"],[1,"ti","ti-search-off","f-30","text-muted"],[1,"mt-3","text-muted"]],template:function(r,e){1&r&&(t.j41(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1"),t.EFF(4,"Informe Final de Inventario"),t.k0s(),t.j41(5,"p"),t.EFF(6,"Reporte consolidado de existencias y novedades"),t.k0s()(),t.j41(7,"div",3)(8,"div",4)(9,"label"),t.EFF(10,"Fecha Inicio"),t.k0s(),t.j41(11,"input",5),t.mxI("ngModelChange",function(a){return t.DH7(e.dateIni,a)||(e.dateIni=a),a}),t.bIt("ngModelChange",function(){return e.loadReport()}),t.k0s()(),t.j41(12,"div",4)(13,"label"),t.EFF(14,"Fecha Fin"),t.k0s(),t.j41(15,"input",5),t.mxI("ngModelChange",function(a){return t.DH7(e.dateEnd,a)||(e.dateEnd=a),a}),t.bIt("ngModelChange",function(){return e.loadReport()}),t.k0s()()()(),t.j41(16,"section",6)(17,"div",7),t.nrm(18,"i",8),t.j41(19,"div",9)(20,"span",10),t.EFF(21),t.nI1(22,"number"),t.k0s(),t.j41(23,"span",11),t.EFF(24,"Referencias \xdanicas"),t.k0s()()(),t.j41(25,"div",12),t.nrm(26,"i",13),t.j41(27,"div",9)(28,"span",10),t.EFF(29),t.nI1(30,"number"),t.k0s(),t.j41(31,"span",11),t.EFF(32,"Total Unidades Capturadas"),t.k0s()()()(),t.j41(33,"div",14)(34,"div",15),t.nrm(35,"i",16),t.j41(36,"input",17),t.mxI("ngModelChange",function(a){return t.DH7(e.searchTerm,a)||(e.searchTerm=a),a}),t.bIt("input",function(){return e.applyFilter()}),t.k0s()(),t.j41(37,"button",18),t.bIt("click",function(){return e.exportToExcel()}),t.nrm(38,"i",19),t.EFF(39," Descargar Reporte Excel "),t.k0s()(),t.j41(40,"div",20),t.nVh(41,m,4,0,"div",21)(42,P,3,1),t.k0s()()),2&r&&(t.R7$(11),t.R50("ngModel",e.dateIni),t.R7$(4),t.R50("ngModel",e.dateEnd),t.R7$(6),t.JRh(t.bMT(22,6,e.totalRefs)),t.R7$(8),t.JRh(t.bMT(30,8,e.totalItems)),t.R7$(7),t.R50("ngModel",e.searchTerm),t.R7$(5),t.vxM(e.isLoading?41:42))},dependencies:[c.MD,c.YU,c.Pc,c.QX,p.YN,p.me,p.BC,p.vS],styles:['@import"https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap";.report-wrapper[_ngcontent-%COMP%]{padding:24px;background:#f8fafc;min-height:100vh;font-family:Inter,sans-serif}.inventory-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#036,#059);padding:2rem;border-radius:16px;color:#fff;margin-bottom:24px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 10px 15px -3px #0363}.inventory-header[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.75rem;font-weight:700;letter-spacing:-.025em}.inventory-header[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;opacity:.8;font-size:.9rem}.inventory-header[_ngcontent-%COMP%]   .filter-params[_ngcontent-%COMP%]{display:flex;gap:16px}.inventory-header[_ngcontent-%COMP%]   .filter-params[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.75rem;font-weight:600;margin-bottom:4px;text-transform:uppercase;opacity:.9}.inventory-header[_ngcontent-%COMP%]   .filter-params[_ngcontent-%COMP%]   .date-input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:#fff;border:none;border-radius:8px;padding:8px 12px;color:#036;font-weight:600;outline:none}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px;margin-bottom:24px}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:12px;display:flex;align-items:center;gap:16px;border-left:6px solid #003366;box-shadow:0 4px 6px -1px #0000000d;transition:transform .2s}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.stats-grid[_ngcontent-%COMP%]   .stat-card.secondary[_ngcontent-%COMP%]{border-left-color:#87d1e6}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{font-size:2.2rem;color:#036;opacity:.2}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-content[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#1e293b;line-height:1}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-content[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#64748b;font-size:.85rem;font-weight:600;margin-top:4px}.action-bar[_ngcontent-%COMP%]{background:#fff;padding:16px;border-radius:12px;margin-bottom:16px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 1px 3px #0000001a}.action-bar[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]{position:relative;width:400px}.action-bar[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#94a3b8}.action-bar[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px 12px 10px 40px;border-radius:8px;border:1px solid #e2e8f0;outline:none;transition:.2s}.action-bar[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#036;box-shadow:0 0 0 3px #0033661a}.action-bar[_ngcontent-%COMP%]   .btn-excel[_ngcontent-%COMP%]{background:#10b981;color:#fff;border:none;padding:10px 20px;border-radius:8px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:8px;transition:.2s}.action-bar[_ngcontent-%COMP%]   .btn-excel[_ngcontent-%COMP%]:hover{background:#059669}.group-item[_ngcontent-%COMP%]{background:#fff;border-radius:12px;margin-bottom:12px;border:1px solid #e2e8f0;overflow:hidden;transition:all .3s cubic-bezier(.4,0,.2,1)}.group-item.active[_ngcontent-%COMP%]{border-color:#036;box-shadow:0 10px 15px -3px #0000001a}.group-item[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]{padding:16px 24px;display:flex;justify-content:space-between;align-items:center;cursor:pointer}.group-item[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .main-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.group-item[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .main-info[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{color:#036;transition:.3s}.group-item[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .main-info[_ngcontent-%COMP%]   .arrow.rotated[_ngcontent-%COMP%]{transform:rotate(90deg)}.group-item[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .main-info[_ngcontent-%COMP%]   .ref-code[_ngcontent-%COMP%]{font-weight:700;color:#036;font-size:1rem;min-width:120px}.group-item[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .main-info[_ngcontent-%COMP%]   .prod-name[_ngcontent-%COMP%]{color:#475569;font-weight:500}.group-item[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .group-badge[_ngcontent-%COMP%]{background:#f1f5f9;padding:6px 16px;border-radius:20px;text-align:right}.group-item[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .group-badge[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{font-weight:800;color:#036;font-size:1.1rem;margin-right:4px}.group-item[_ngcontent-%COMP%]   .group-header[_ngcontent-%COMP%]   .group-badge[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.7rem;color:#64748b;font-weight:700;text-transform:uppercase}.group-item[_ngcontent-%COMP%]   .group-detail[_ngcontent-%COMP%]{padding:0 24px 24px 64px;border-top:1px solid #f1f5f9;background:#f8fafc}.group-item[_ngcontent-%COMP%]   .group-detail[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{width:100%}.group-item[_ngcontent-%COMP%]   .group-detail[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;text-transform:uppercase;color:#64748b;padding:12px 8px;border-bottom:2px solid #e2e8f0}.group-item[_ngcontent-%COMP%]   .group-detail[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 8px;font-size:.85rem;border-bottom:1px solid #e2e8f0}.group-item[_ngcontent-%COMP%]   .group-detail[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#f1f5f9;padding:2px 6px;border-radius:4px;color:#036;font-weight:600}']})}}return o})()}}]);